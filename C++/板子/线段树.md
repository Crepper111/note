# 线段树

> 线段树好闪，拜谢线段树

[P3372 【模板】线段树 1](https://www.luogu.com.cn/problem/P3372)

```cpp
#define ls (id*2)
#define rs (id*2+1)
#define mid ((l+r)/2)
int t[N*4],lz[N*4];
void push_up(int id)
{
	t[id]=t[ls]+t[rs];
}
void build(int id,int l,int r)
{
	if(l==r)
	{
		t[id]=a[l];
		return;
	}
	build(ls,l,mid);
	build(rs,mid+1,r);
	push_up(id);
}
void push_down(int id,int l,int r)
{
	t[ls]+=(mid-l+1)*lz[id];
	t[rs]+=(r-mid)*lz[id];
	lz[ls]+=lz[id];
	lz[rs]+=lz[id];
	lz[id]=0;
}
void add(int id,int l,int r,int x,int y,int val)
{
	if(x<=l&&r<=y)
	{
		t[id]+=(r-l+1)*val;
		lz[id]+=val;
		return;
	}
	push_down(id,l,r);
	if(x<=mid) add(ls,l,mid,x,y,val);
	if(y>mid) add(rs,mid+1,r,x,y,val);
	push_up(id);
}
int find(int id,int l,int r,int x,int y)
{
	if(x<=l&&r<=y)
	{
		return t[id];
	}
	push_down(id,l,r);
	int ans=0;
	if(x<=mid) ans+=find(ls,l,mid,x,y);
	if(y>mid) ans+=find(rs,mid+1,r,x,y);
	return ans;
}
```